<!DOCTYPE html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Electron & MySQL</title>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
  <style>
    body {
  margin: 0;
  padding: 0;
}
 
#products {
  height: 100vh;
  overflow-y: auto;
  padding: 2px
}
  </style>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.2/animate.min.css">
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body onload="idfind()">
    <main class="container-flude">
        <div class="row">
            <div class="col-md-8 p-4 my-auto">
                <form id="salesForm" class="card card-body">
                  <div align ="right">
                  <a type="submit" class="btn btn-primary" onclick="location.href='sales.html'">back</a>
                </div>
                  <div class="form-group">
                    <label>Invoice No:</label>
                      <input type="number" id="invoiceno" class="form-control">
                    </div>
                    <div class="form-group">
                    <label>Sales Date:</label>
                    <input type="date" id="salesdate" class="form-control"/>
                    </div>
                    <div class="form-group">
                      <label>Customer Name:</label></br>
                      <input type="text" id="name" class="form-control" autofocus>
                    </div>
                    <div class="form-group">
                    <label>Address:</label>
                      <input type="text" id="address"  class="form-control" autofocus>
                    </div>
                    <div class="form-group">
                    <label>Country:</label>
                    <select id="country" onchange="random_function()" class="form-control" autofocus>
                      <option value="">select option</option>
                      <option value="INDIA">INDIA</option>
                     </select>
                    </div>
                    <div class="form-group">
                      <label>state:</label>
                     <select id="state" onchange="" class="form-control" autofocus>
                     <option value="">select option</option></select>
                   </div>
                   <div class="form-group">
                   <label>city:</label>
                    <select id="city" onchange="" class="form-control" autofocus>
                      <option value="">select option</option>
                      <option value="vadodara">vadodara</option>
                      <option value="mehsana">mehsana</option>
                     </select>
                    </div>
                   <div class="form-group">
                    <label>Contact No:</label>
                      <input type="number" id="phone" class="form-control">
                    </div>
                    
                    <div class="form-group">
                    <label>order_no:</label>
                      <input type="text" id="orderno" class="form-control">
                    </div>
                    <div class="form-group">
                    <label>Products:</label>
                    <select class="form-control" name="category" id="prod">
                      <option value="">N/A</option>
                  </select> 
                    </div>
                    <div class="form-group">
                    <label>Product Varients:</label>
                    <select id="provarients" class="form-control">
                        <option value="">N/A</option>
                    </select>
                    </div>
                    <div class="form-group">
                    <label>quantity:</label>
                      <input type="number" id="qnt" class="form-control" onblur="getVal()">
                    </div>
                    <div class="form-group">
                    <label>Price:</label>
                      <input type="number" id="price" class="form-control" onblur="getVal()">
                    </div>
                    <div class="form-group">
                    <label>Description:</label>
                      <textarea type="text" id="prodesc" class="form-control"></textarea>
                    </div>
                    <div class="form-group">
                    <label>Gross Amount:</label>
                      <input type="number" id="grossamount" class="form-control">
                    </div>
                    <div class="form-group">
                    <label>GST %:</label>
                      <input type="number" id="gst" class="form-control" onblur="getVal()">
                    </div>
                     <div class="form-group">
                    <label>Total Amount:</label>
                      <input type="number" id="totalamount" class="form-control">
                    </div></br>
                    <div align ="center">
                    <button type="submit" class="btn btn-primary">
                      Save
                    </button>
                </div>
                </form>
            </div>
            <!-- Product List -->
             <div class="col-md-6">
                <div id="products">
                </div>
            </div>
        </div>
    </main>
</body>
 <script type="module" src="./addSales.js"></script>
 <script>
  function random_function()
  {
      var a=document.getElementById("country").value;
      if(a==="INDIA")
      {
          var arr=["Gujarat"];
      }
     var string="";
   
      for(i=0;i<arr.length;i++)
      {
          string=string+"<option value="+arr[i]+">"+arr[i]+"</option>";
      }
      document.getElementById("state").innerHTML=string;
  }
</script>
<script>
  const main = require('../main');
  const moment= require('moment');
  function idfind(){
        const ids = main.getInvoiceId().then(function(result){
         if(result[0][0] == undefined){
          document.getElementById("invoiceno").value = 1 ;
          }
          const id = result[0][0]['invoice_no'];
          document.getElementById("invoiceno").value = id + 1 ;

        })
        // for products listing
        const products = main.getAllProducts().then(function(result){
        const productName = result;
        for (let i = 0; i < productName.length; i++) {
                let optn = productName[0][i]['name'];
                let el = document.createElement("option");
                el.textContent = optn;
                el.value = optn;
              document.getElementById('prod').appendChild(el);
            }
        })
        const salesProducts = main.getAllProductVarients().then(function(result){
        const salesProduct = result;
        for (let i = 0; i < salesProduct.length; i++) {
                let optn = salesProduct[0][i]['name'];
                let el = document.createElement("option");
                el.textContent = optn;
                el.value = optn;
              document.getElementById('provarients').appendChild(el);
            }
        })
        
      }
</script>
<script>
  function getVal() {
  const val1 = document.getElementById('qnt').value;
  const val2 = document.getElementById('price').value;
  document.getElementById('grossamount').value = (val1*val2);
  const grossamount =document.getElementById('grossamount').value

  const gst = document.getElementById('gst').value;
  const gstAmount =((grossamount*gst)/100);
  // const totalamount = grossamount + gstAmount;
  num1 = parseInt(document.getElementById("grossamount").value);
  num2 = parseInt(gstAmount);
   document.getElementById('totalamount').value = num1+num2;

}
</script>
<script>
  //for sales date bydefualt selected
  document.getElementById('salesdate').valueAsDate = new Date();
</script>
</html>